/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.incosyz.sms.panel;

import com.incosyz.sms.clientcontroller.CustomerControllerImplClient;
import com.incosyz.sms.dialog.EditSale;
import com.incosyz.sms.mixmodel.GETOrderModel;
import com.incosyz.sms.model.CustomerModel;
import com.incosyz.sms.model.HomePhoneModel;
import com.incosyz.sms.model.MobileModel;
import java.net.MalformedURLException;
import java.rmi.NotBoundException;
import java.rmi.RemoteException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.JTextField;

/**
 * Date : Nov 16, 2015 Time : 6:41:03 PM
 *
 * @copyright INCOSYZ
 * @author Stelan
 */
public class EditCustomerPanel extends javax.swing.JPanel {

    /**
     * Creates new form EditCustomerPanel
     */
    public EditCustomerPanel() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        customerNameText = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        nicNoText = new javax.swing.JTextField();
        addressLineThreeText = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        addressLineOneText = new javax.swing.JTextField();
        addressLineTwoText = new javax.swing.JTextField();
        mobileNoFourText = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        mobileNoOneText = new javax.swing.JTextField();
        mobileNoTwoText = new javax.swing.JTextField();
        phoneNoThreeText = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        phoneNoOneText = new javax.swing.JTextField();
        phoneNoTwoText = new javax.swing.JTextField();
        mobileNoThreeText = new javax.swing.JTextField();
        doneButton = new javax.swing.JButton();

        setBackground(new java.awt.Color(255, 255, 255));
        setLayout(null);

        customerNameText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                customerNameTextActionPerformed(evt);
            }
        });
        add(customerNameText);
        customerNameText.setBounds(200, 60, 230, 30);

        jLabel1.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel1.setText("Customer Name :");
        add(jLabel1);
        jLabel1.setBounds(200, 30, 130, 30);

        jLabel2.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel2.setText("NIC No :");
        add(jLabel2);
        jLabel2.setBounds(200, 110, 130, 30);

        nicNoText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                nicNoTextActionPerformed(evt);
            }
        });
        add(nicNoText);
        nicNoText.setBounds(200, 140, 230, 30);

        addressLineThreeText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                addressLineThreeTextActionPerformed(evt);
            }
        });
        add(addressLineThreeText);
        addressLineThreeText.setBounds(200, 280, 230, 30);

        jLabel3.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel3.setText("Address :");
        add(jLabel3);
        jLabel3.setBounds(200, 190, 130, 30);

        addressLineOneText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                addressLineOneTextActionPerformed(evt);
            }
        });
        addressLineOneText.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                addressLineOneTextKeyPressed(evt);
            }
        });
        add(addressLineOneText);
        addressLineOneText.setBounds(200, 220, 230, 30);

        addressLineTwoText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                addressLineTwoTextActionPerformed(evt);
            }
        });
        addressLineTwoText.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                addressLineTwoTextKeyReleased(evt);
            }
        });
        add(addressLineTwoText);
        addressLineTwoText.setBounds(200, 250, 230, 30);

        mobileNoFourText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mobileNoFourTextActionPerformed(evt);
            }
        });
        add(mobileNoFourText);
        mobileNoFourText.setBounds(470, 150, 230, 30);

        jLabel4.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel4.setText("Mobile No :");
        add(jLabel4);
        jLabel4.setBounds(470, 30, 100, 30);

        mobileNoOneText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mobileNoOneTextActionPerformed(evt);
            }
        });
        add(mobileNoOneText);
        mobileNoOneText.setBounds(470, 60, 230, 30);

        mobileNoTwoText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mobileNoTwoTextActionPerformed(evt);
            }
        });
        add(mobileNoTwoText);
        mobileNoTwoText.setBounds(470, 90, 230, 30);
        add(phoneNoThreeText);
        phoneNoThreeText.setBounds(470, 280, 230, 30);

        jLabel5.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel5.setText("Home / Office Phone : ");
        add(jLabel5);
        jLabel5.setBounds(470, 190, 180, 30);

        phoneNoOneText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                phoneNoOneTextActionPerformed(evt);
            }
        });
        add(phoneNoOneText);
        phoneNoOneText.setBounds(470, 220, 230, 30);

        phoneNoTwoText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                phoneNoTwoTextActionPerformed(evt);
            }
        });
        add(phoneNoTwoText);
        phoneNoTwoText.setBounds(470, 250, 230, 30);

        mobileNoThreeText.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mobileNoThreeTextActionPerformed(evt);
            }
        });
        add(mobileNoThreeText);
        mobileNoThreeText.setBounds(470, 120, 230, 30);

        doneButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/incosyz/sms/image/done.jpg"))); // NOI18N
        doneButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                doneButtonActionPerformed(evt);
            }
        });
        add(doneButton);
        doneButton.setBounds(590, 360, 110, 50);
    }// </editor-fold>//GEN-END:initComponents

    private void customerNameTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_customerNameTextActionPerformed
        nicNoText.requestFocus();
    }//GEN-LAST:event_customerNameTextActionPerformed

    private void nicNoTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_nicNoTextActionPerformed

    }//GEN-LAST:event_nicNoTextActionPerformed

    private void addressLineThreeTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addressLineThreeTextActionPerformed
        mobileNoOneText.requestFocus();
    }//GEN-LAST:event_addressLineThreeTextActionPerformed

    private void addressLineOneTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addressLineOneTextActionPerformed
        if (addressLineOneText.getText().trim().equals("")) {
            mobileNoOneText.requestFocus();
        } else {
            addressLineTwoText.requestFocus();
        }
    }//GEN-LAST:event_addressLineOneTextActionPerformed

    private void addressLineOneTextKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_addressLineOneTextKeyPressed

    }//GEN-LAST:event_addressLineOneTextKeyPressed

    private void addressLineTwoTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addressLineTwoTextActionPerformed
        if (addressLineTwoText.getText().trim().equals("")) {
            mobileNoOneText.requestFocus();
        } else {
            addressLineThreeText.requestFocus();
        }
    }//GEN-LAST:event_addressLineTwoTextActionPerformed

    private void addressLineTwoTextKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_addressLineTwoTextKeyReleased

    }//GEN-LAST:event_addressLineTwoTextKeyReleased

    private void mobileNoFourTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mobileNoFourTextActionPerformed
        phoneNoOneText.requestFocus();
    }//GEN-LAST:event_mobileNoFourTextActionPerformed

    private void mobileNoOneTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mobileNoOneTextActionPerformed
        if (mobileNoOneText.getText().trim().equals("")) {
            phoneNoOneText.requestFocus();
        } else {
            mobileNoTwoText.requestFocus();
        }
    }//GEN-LAST:event_mobileNoOneTextActionPerformed

    private void mobileNoTwoTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mobileNoTwoTextActionPerformed
        if (mobileNoTwoText.getText().trim().equals("")) {
            phoneNoOneText.requestFocus();
        } else {
            mobileNoThreeText.requestFocus();
        }
    }//GEN-LAST:event_mobileNoTwoTextActionPerformed

    private void phoneNoOneTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_phoneNoOneTextActionPerformed
        if (phoneNoOneText.getText().trim().equals("")) {
            doneButton.doClick();
        } else {
            phoneNoTwoText.requestFocus();
        }
    }//GEN-LAST:event_phoneNoOneTextActionPerformed

    private void phoneNoTwoTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_phoneNoTwoTextActionPerformed
        if (phoneNoTwoText.getText().trim().equals("")) {
            doneButton.doClick();
        } else {
            phoneNoThreeText.requestFocus();
        }
    }//GEN-LAST:event_phoneNoTwoTextActionPerformed

    private void mobileNoThreeTextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mobileNoThreeTextActionPerformed
        if (mobileNoThreeText.getText().trim().equals("")) {
            phoneNoOneText.requestFocus();
        } else {
            mobileNoFourText.requestFocus();
        }
    }//GEN-LAST:event_mobileNoThreeTextActionPerformed

    private void doneButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_doneButtonActionPerformed
        String customerName = customerNameText.getText();
        String nic = nicNoText.getText();
        String addressOne = addressLineOneText.getText();
        String addressTwo = addressLineTwoText.getText();
        String addressThree = addressLineThreeText.getText();

        CustomerModel customerModel = new CustomerModel()
                .setCustomerId(this.customerModel.getCustomerId())
                .setCustomerName(customerName)
                .setNicNo(nic)
                .setAddressLineOne(addressOne)
                .setAddressLineTwo(addressTwo)
                .setAddressLineThree(addressThree);

        ArrayList<MobileModel> mobileModels = new ArrayList<>();
        String mobileOne = mobileNoOneText.getText();
        String mobileTwo = mobileNoTwoText.getText();
        String mobileThree = mobileNoThreeText.getText();
        String mobileFour = mobileNoFourText.getText();

        if (!mobileOne.trim().equals("")) {
            String mobileId = "";
            if (this.mobileModels.get(0) != null) {
                mobileId = this.mobileModels.get(0).getMobileId();
            }

            MobileModel mobileModel = new MobileModel()
                    .setMobileId(mobileId)
                    .setMobileNo(mobileOne);
            mobileModels.add(mobileModel);
        }

        if (!mobileTwo.trim().equals("")) {
            String mobileId = "";
            if (this.mobileModels.get(1) != null) {
                mobileId = this.mobileModels.get(1).getMobileId();
            }

            MobileModel mobileModel = new MobileModel()
                    .setMobileId(mobileId)
                    .setMobileNo(mobileTwo);
            mobileModels.add(mobileModel);
        }

        if (!mobileThree.trim().equals("")) {
            String mobileId = "";
            if (this.mobileModels.get(2) != null) {
                mobileId = this.mobileModels.get(2).getMobileId();
            }

            MobileModel mobileModel = new MobileModel()
                    .setMobileId(mobileId)
                    .setMobileNo(mobileThree);
            mobileModels.add(mobileModel);
        }
        if (!mobileFour.trim().equals("")) {
            String mobileId = "";
            if (this.mobileModels.get(3) != null) {
                mobileId = this.mobileModels.get(3).getMobileId();
            }

            MobileModel mobileModel = new MobileModel()
                    .setMobileId(mobileId)
                    .setMobileNo(mobileFour);
            mobileModels.add(mobileModel);
        }

        ArrayList<HomePhoneModel> homePhoneModels = new ArrayList<>();
        String homePhoneOne = phoneNoOneText.getText();
        String homePhoneTwo = phoneNoTwoText.getText();
        String homePhoneThree = phoneNoThreeText.getText();

        if (!homePhoneOne.trim().equals("")) {
            String homePhoneId = "";
            if (this.homePhoneModels.get(0) != null) {
                homePhoneId = this.homePhoneModels.get(0).getHomePhoneId();
            }

            HomePhoneModel homePhoneModel = new HomePhoneModel()
                    .setHomePhoneId(homePhoneId)
                    .setHomePhoneNo(homePhoneOne);
            homePhoneModels.add(homePhoneModel);
        }

        if (!homePhoneTwo.trim().equals("")) {
            String homePhoneId = "";
            if (this.homePhoneModels.get(1) != null) {
                homePhoneId = this.homePhoneModels.get(1).getHomePhoneId();
            }

            HomePhoneModel homePhoneModel = new HomePhoneModel()
                    .setHomePhoneId(homePhoneId)
                    .setHomePhoneNo(homePhoneTwo);
            homePhoneModels.add(homePhoneModel);
        }

        if (!homePhoneThree.trim().equals("")) {
            String homePhoneId = "";
            if (this.homePhoneModels.get(2) != null) {
                homePhoneId = this.homePhoneModels.get(2).getHomePhoneId();
            }

            HomePhoneModel homePhoneModel = new HomePhoneModel()
                    .setHomePhoneId(homePhoneId)
                    .setHomePhoneNo(homePhoneThree);
            homePhoneModels.add(homePhoneModel);
        }

        try {
            boolean updateCustomer = CustomerControllerImplClient.updateCustomer(customerModel);
            boolean updateMobile = CustomerControllerImplClient.updateMobile(mobileModels);
            boolean updateHome = CustomerControllerImplClient.updateHome(homePhoneModels);

            if (updateCustomer && updateMobile && updateHome) {
                JOptionPane.showMessageDialog(this, "Customer Details Updated !");
            }

            if (!updateHome) {
                JOptionPane.showMessageDialog(this, "Home/Office Contacts update failed !");
            }
            if (!updateMobile) {
                JOptionPane.showMessageDialog(this, "Mobile Contacts update failed !");
            }

        } catch (NotBoundException | MalformedURLException | ClassNotFoundException | SQLException | RemoteException ex) {
            Logger.getLogger(EditCustomerPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_doneButtonActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField addressLineOneText;
    private javax.swing.JTextField addressLineThreeText;
    private javax.swing.JTextField addressLineTwoText;
    private javax.swing.JTextField customerNameText;
    private javax.swing.JButton doneButton;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JTextField mobileNoFourText;
    private javax.swing.JTextField mobileNoOneText;
    private javax.swing.JTextField mobileNoThreeText;
    private javax.swing.JTextField mobileNoTwoText;
    private javax.swing.JTextField nicNoText;
    private javax.swing.JTextField phoneNoOneText;
    private javax.swing.JTextField phoneNoThreeText;
    private javax.swing.JTextField phoneNoTwoText;
    // End of variables declaration//GEN-END:variables

    private EditSale editSale;
    private CustomerModel customerModel;
    private ArrayList<MobileModel> mobileModels;
    private ArrayList<HomePhoneModel> homePhoneModels;

    public void setFrame(EditSale editSale) {
        this.editSale = editSale;
    }

    public void setDetail(CustomerModel customerModel, ArrayList<MobileModel> mobileModels, ArrayList<HomePhoneModel> homePhoneModels) {
        this.customerModel = customerModel;
        this.mobileModels = mobileModels;
        this.homePhoneModels = homePhoneModels;

        customerNameText.setText(customerModel.getCustomerName());
        nicNoText.setText(customerModel.getNicNo());
        addressLineOneText.setText(customerModel.getAddressLineOne());
        addressLineTwoText.setText(customerModel.getAddressLineTwo());
        addressLineThreeText.setText(customerModel.getAddressLineThree());

        JTextField[] fields = {mobileNoOneText, mobileNoTwoText, mobileNoThreeText, mobileNoFourText};

        for (int i = 0; i < mobileModels.size(); i++) {
            fields[i].setText(mobileModels.get(i).getMobileNo());
        }

        JTextField[] hFields = {phoneNoOneText, phoneNoTwoText, phoneNoThreeText};

        for (int i = 0; i < homePhoneModels.size(); i++) {
            hFields[i].setText(homePhoneModels.get(i).getHomePhoneNo());
        }

    }
}
